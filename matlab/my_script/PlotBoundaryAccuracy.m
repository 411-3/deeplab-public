% plot the boundary accuracy before and after crf refinement
%
clear all; close all;

save_folder = '.';

export_fig_dir = '~/workspace/ext/export_fig';
addpath(export_fig_dir);

fontSize = 20;
lineWidth = 2;

subsample = 3;

cols = [...
    92 173 173; ...
    128 128 192; ...
    173 90 90; ...
    ] / 255;

% data
% row1: noup, row2: ms, row3: noup+crf
pixelIOU = [39.1437885768888,40.9174913566480,42.5750968327488,44.1119698229399,45.5143333902976,46.7888007054941,47.9474395959582,48.9987195339916,49.9562761308168,50.8274348079370,51.6199418151972,52.3408776226153,53.0048800416164,53.6173863958030,54.1802129076264,54.6989675611266,55.1792759482687,55.6237417417372,56.0373525024838,56.4224864728447,56.7805992879315,57.1134185595957,57.4236637950213,57.7139226511121,57.9870942964121,58.2434411759406,58.4820168827609,58.7026272392923,58.9082213822727,59.0998098338864,59.2780799882757,59.4445643572098,59.6001745920688,59.7455099141624,59.8805382908630,60.0065637761586,60.1242322555913,60.2333065445936,60.3344098524545,60.4283472979397;
                   40.8283847133684,42.7985590853589,44.5699164497078,46.1520844631380,47.5435370542755,48.7656811281391,49.8484543310518,50.8184991635295,51.6944145725429,52.4879595126815,53.2092430480340,53.8639790246465,54.4660536565788,55.0204958479888,55.5308069140149,56.0017084453616,56.4394170592652,56.8458460741117,57.2239235407487,57.5759295382279,57.9031810014464,58.2067425394842,58.4891177625032,58.7526247279374,59.0004477547628,59.2330076158429,59.4492098247426,59.6484084579877,59.8337163833758,60.0065591872221,60.1675199649759,60.3179200034926,60.4584549236908,60.5892859709992,60.7106012185241,60.8234998476352,60.9288901667356,61.0262289253648,61.1164365376277,61.2001644700927;
                   45.8592389975158,47.7919542135458,49.2939715561577,50.5636179148377,51.6595183146572,52.6285842412855,53.4949528345474,54.2833898680924,55.0109887033417,55.6817421685352,56.2970137133449,56.8620406292664,57.3863490664163,57.8731201842615,58.3229236228278,58.7401403232454,59.1305121257240,59.4945181762249,59.8351044216730,60.1543590976979,60.4537367731081,60.7335323128566,60.9962192467884,61.2440829483582,61.4787119438196,61.6994862124264,61.9063219984830,62.0997066151967,62.2814092531390,62.4511114520202,62.6100651398902,62.7595495718118,62.8999690364675,63.0319701711305,63.1558109152548,63.2725779727555,63.3825291179991,63.4855832599294,63.5824377991762,63.6735677212769;];
pixelAcc = [59.7629424526230,62.1046593040550,64.2285694944071,66.1566207985699,67.8822191048322,69.4156572369610,70.7799195920376,71.9934840646315,73.0769758056989,74.0478885040478,74.9204707863011,75.7084821132611,76.4256934738625,77.0816897085976,77.6832958750408,78.2379357794231,78.7518178661264,79.2293619012470,79.6745963627096,80.0911555036860,80.4816137647666,80.8485717205549,81.1939278781263,81.5195519345717,81.8278832214066,82.1194870930650,82.3951544526424,82.6556945507432,82.9031661080965,83.1386100849198,83.3626553900388,83.5764568351612,83.7805568445914,83.9754420822593,84.1615279065981,84.3395567209560,84.5102367112354,84.6737806988873,84.8302916657287,84.9804151959184;
                  61.7208038340988,64.2401176287481,66.4400008982705,68.3560196658801,70.0043501328594,71.4224875981037,72.6565686534466,73.7411802053026,74.7027281008609,75.5608889763180,76.3323681460966,77.0295168046933,77.6646791187703,78.2466140909030,78.7819687579461,79.2769006331850,79.7375589042388,80.1674882445178,80.5691421823391,80.9459694341276,81.3004822338965,81.6343827901208,81.9491116325446,82.2462335033681,82.5279973625908,82.7950559301802,83.0478404561792,83.2869055056065,83.5141510067593,83.7307065077119,83.9372257041223,84.1345373400715,84.3229449119103,84.5028279982126,84.6747230945372,84.8393158111443,84.9974674884393,85.1492028576134,85.2946735274968,85.4344288299327;
                  67.8073316515599,69.8354673998244,71.4336430305435,72.7877951994489,73.9600407860754,74.9941180003672,75.9176261038161,76.7512754059539,77.5091399495764,78.1998576992880,78.8295005821076,79.4070770332584,79.9394877203003,80.4323215906510,80.8889003909751,81.3139803694874,81.7121506892801,82.0856448018074,82.4362312231826,82.7666781325468,83.0791798897034,83.3750296827982,83.6554277852380,83.9218400214134,84.1755321179127,84.4165653422791,84.6456545882318,84.8636435054509,85.0717857553965,85.2704579453905,85.4602655935009,85.6420843218994,85.8161622729709,85.9829074377913,86.1429243857804,86.2966535297716,86.4446412012502,86.5871474792545,86.7241951074942,86.8562424217199;];
classAcc = [53.6166685540976,55.5967948018896,57.3237320882869,58.8544956209996,60.2017948442793,61.3905329213579,62.4435967537027,63.3767878079031,64.2114199609301,64.9602832099546,65.6349639291829,66.2446959257892,66.8016831382256,67.3131208966184,67.7819893750422,68.2130478820972,68.6114093174701,68.9792673501668,69.3202552246368,69.6372715278773,69.9317591919854,70.2047885169115,70.4591450299554,70.6972544536765,70.9212770194682,71.1315392902723,71.3271970434733,71.5080894239389,71.6770942904036,71.8349143599890,71.9822606155026,72.1205121698443,72.2505036841062,72.3726692253487,72.4868853415123,72.5941389864676,72.6951384233662,72.7893027342883,72.8772228428703,72.9595201816422;
                  55.3530867863591,57.4251600883353,59.1654069254999,60.6577460083697,61.9317644360812,63.0292371000109,63.9863354351023,64.8333651559611,65.5930147509049,66.2770953058674,66.8946229562121,67.4525828543541,67.9627179751334,68.4317033328142,68.8636585047224,69.2616996653449,69.6311086602684,69.9734377395689,70.2905406054787,70.5851916962493,70.8583900231628,71.1108680982764,71.3456555978024,71.5649616525127,71.7710855734037,71.9643008151337,72.1439215225654,72.3096635667136,72.4643629438726,72.6091758955181,72.7445829138534,72.8716584172568,72.9912239841387,73.1033984225974,73.2081880721397,73.3063060501353,73.3985844232644,73.4844395669407,73.5646472412804,73.6397739985044;
                  56.1387661899619,58.1788189832075,59.7172861585686,60.9961248002105,62.0810119108635,63.0262191034398,63.8574442750947,64.6029557452942,65.2839522917626,65.9046916490366,66.4695763149141,66.9859289202305,67.4615153399251,67.9006064300342,68.3043209974268,68.6771714973569,69.0249626715739,69.3483240036955,69.6504064167114,69.9329271849371,70.1971631900816,70.4435344090442,70.6743319516664,70.8916471289184,71.0969316304493,71.2895122660372,71.4695627598046,71.6377906909983,71.7959358292434,71.9438935579413,72.0827232110529,72.2133976518177,72.3363745011860,72.4524566646415,72.5618978136188,72.6652433255044,72.7629114973707,72.8545300250049,72.9407927720727,73.0219786746801;];

w = 1 : size(pixelIOU, 2);

% pixel iou
figure(1)

plot(w(1:subsample:end), 100 - pixelIOU(1,1:subsample:end), '-rx', 'LineWidth', lineWidth, 'color', cols(1,:));
hold on
plot(w(1:subsample:end), 100 - pixelIOU(2,1:subsample:end), '-ro', 'LineWidth', lineWidth, 'color', cols(2,:));
plot(w(1:subsample:end), 100 - pixelIOU(3,1:subsample:end), '-rs', 'LineWidth', lineWidth, 'color', cols(3,:));
ylabel('1 - mean IOU (%)', 'FontSize', fontSize) 
xlabel('Trimap Width (pixels)', 'FontSize', fontSize)

leg = legend('Baseline', 'Multi-Scale', 'Baseline+CRF');
set(leg, 'FontSize', fontSize, 'Position', [0.45 0.70 0.44 0.2]);
set(gca, 'XGrid', 'on')
set(gca, 'YGrid', 'on');
set(gca,'FontSize', fontSize);
set(leg, 'FontSize', fontSize);
set(gcf, 'Color', [1 1 1]);

fn = fullfile(save_folder, 'SegPixelIOUWithinTrimap.pdf');
export_fig(fn);

% pixel acc
% figure(2)
% 
% plot(w, 100 - pixelAcc(1,:), '-rx', 'LineWidth', lineWidth, 'color', cols(1,:));
% hold on
% plot(w, 100 - pixelAcc(2,:), '-ro', 'LineWidth', lineWidth, 'color', cols(2,:));
% plot(w, 100 - pixelAcc(3,:), '-rs', 'LineWidth', lineWidth, 'color', cols(3,:));
% ylabel('1 - Pixelwise Accuracy (%)', 'FontSize', fontSize) 
% xlabel('Trimap Width (pixels)', 'FontSize', fontSize)
% 
% %     plot(trainEnergyRI, '-r', 'LineWidth', 2.8, 'color', cols(1,:));
% %     hold on
% %     plot(trainEnergyPw, '-r', 'LineWidth', 2.8, 'color', cols(3,:));
% %     plot(trainEnergyPre, '-r', 'LineWidth', 2.8, 'color', cols(5,:));
% %leg = legend('Model-RandInit', 'Model-PwTrain', 'Model-JointTrain');
% leg = legend('Baseline', 'Multi-Scale', 'Baseline+CRF');
% set(leg, 'FontSize', fontSize, 'Position', [0.45 0.70 0.44 0.2]);
% set(gca, 'XGrid', 'on')
% set(gca, 'YGrid', 'on');
% set(gca,'FontSize', fontSize);
% set(leg, 'FontSize', fontSize);
% set(gcf, 'Color', [1 1 1]);
% 
% fn = fullfile(save_folder, 'SegPixelAccWithTrimap.pdf');
% export_fig(fn);    
% 
% % class acc
% figure(3)
% 
% plot(w, 100 - classAcc(1,:), '-rx', 'LineWidth', lineWidth, 'color', cols(1,:));
% hold on
% plot(w, 100 - classAcc(2,:), '-ro', 'LineWidth', lineWidth, 'color', cols(2,:));
% plot(w, 100 - classAcc(3,:), '-rs', 'LineWidth', lineWidth, 'color', cols(3,:));
% ylabel('1 - Classwise Accuracy (%)', 'FontSize', fontSize) 
% xlabel('Trimap Width (pixels)', 'FontSize', fontSize)
% 
% leg = legend('Baseline', 'Multi-Scale', 'Baseline+CRF');
% set(leg, 'FontSize', fontSize, 'Position', [0.45 0.70 0.44 0.2]);
% set(gca, 'XGrid', 'on')
% set(gca, 'YGrid', 'on');
% set(gca,'FontSize', fontSize);
% set(leg, 'FontSize', fontSize);
% set(gcf, 'Color', [1 1 1]);
% 
% fn = fullfile(save_folder, 'SegClassAccWithTrimap.pdf');
% export_fig(fn);